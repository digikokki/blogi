!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Rainbow=e()}(this,function(){"use strict";function t(){return"undefined"!=typeof module&&"object"==typeof module.exports}function e(){return"undefined"==typeof document&&"undefined"!=typeof self}function n(t){var e=t.getAttribute("data-language")||t.parentNode.getAttribute("data-language");if(!e){var n=/\blang(?:uage)?-(\w+)/,a=t.className.match(n)||t.parentNode.className.match(n);a&&(e=a[1])}return e?e.toLowerCase():null}function a(t,e,n,a){return(n!==t||a!==e)&&n<=t&&a>=e}function r(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;")}function s(t,e){for(var n=0,a=1;a<e;++a)t[a]&&(n+=t[a].length);return n}function o(t,e,n,a){return n>=t&&n<e||a>t&&a<e}function i(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e.sort(function(t,e){return e-t})}function c(t,e,n,a){var r=a.substr(t);return a.substr(0,t)+r.replace(e,n)}function p(e,n){if(t())return global.Worker=require("webworker-threads").Worker,new Worker(__filename);var p=n.toString(),g=i.toString();g+=r.toString(),g+=a.toString(),g+=o.toString(),g+=c.toString(),g+=s.toString(),g+=p;var u=p.match(/function (\w+?)\(/)[1],l=e.toString();l=l.replace(/=new \w+/,"= new "+u);var m=g+"\tthis.onmessage ="+l,d=new Blob([m],{type:"text/javascript"});return new Worker((window.URL||window.webkitURL).createObjectURL(d))}function g(t){function e(){self.postMessage({id:n.id,lang:n.lang,result:r})}var n=t.data,a=new k(n.options),r=a.refract(n.code,n.lang);return n.isNode?(e(),void self.close()):void setTimeout(function(){e()},1e3*n.options.delay)}function u(){return(C||null===T)&&(T=p(g,k)),T}function l(t,e){function n(r){r.data.id===t.id&&(e(r.data),a.removeEventListener("message",n))}var a=u();a.addEventListener("message",n),a.postMessage(t)}function m(t,e,n){return function(a){t.innerHTML=a.result,t.classList.remove("loading"),"PRE"===t.parentNode.tagName&&t.parentNode.classList.remove("loading"),S&&S(t,a.lang),0===--e.c&&n()}}function d(t){return{patterns:R,inheritenceMap:E,aliases:A,globalClass:t.globalClass,delay:isNaN(t.delay)?0:t.delay}}function f(t,e){var n={};"object"==typeof e&&(n=e,e=n.language),e=A[e]||e;var a={id:String.fromCharCode(65+Math.floor(26*Math.random()))+Date.now(),code:t,lang:e,options:d(n),isNode:C};return a}function h(t,e){for(var a={c:0},r=0,s=t;r<s.length;r+=1){var o=s[r],i=n(o);if(!o.classList.contains("rainbow")&&i){o.classList.add("loading"),o.classList.add("rainbow"),"PRE"===o.parentNode.tagName&&o.parentNode.classList.add("loading");var c=o.getAttribute("data-global-class"),p=parseInt(o.getAttribute("data-delay"),10);++a.c,l(f(o.innerHTML,{language:i,globalClass:c,delay:p}),m(o,a,e))}}0===a.c&&e()}function v(t){var e=document.createElement("div");e.className="preloader";for(var n=0;n<7;n++)e.appendChild(document.createElement("div"));t.appendChild(e)}function y(t,e){e=e||function(){},t=t&&"function"==typeof t.getElementsByTagName?t:document;for(var n=t.getElementsByTagName("pre"),a=t.getElementsByTagName("code"),r=[],s=[],o=0,i=n;o<i.length;o+=1){var c=i[o];v(c),c.getElementsByTagName("code").length?c.getAttribute("data-trimmed")||(c.setAttribute("data-trimmed",!0),c.innerHTML=c.innerHTML.trim()):r.push(c)}for(var p=0,g=a;p<g.length;p+=1){var u=g[p];s.push(u)}h(s.concat(r),e)}function b(t){S=t}function w(t,e,n){E[t]||(E[t]=n),R[t]=e.concat(R[t]||[])}function x(t){delete E[t],delete R[t]}function N(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if("string"==typeof t[0]){var n=f(t[0],t[1]);return void l(n,function(t){return function(e){t&&t(e.result,e.lang)}}(t[2]))}return"function"==typeof t[0]?void y(0,t[0]):void y(t[0],t[1])}function L(t,e){A[t]=e}var S,k=function I(t){function e(t,e){for(var n in v)if(n=parseInt(n,10),a(n,v[n],t,e)&&(delete v[n],delete h[n]),o(n,v[n],t,e))return!0;return!1}function n(e,n){var a=e.replace(/\./g," "),r=t.globalClass;return r&&(a+=" "+r),'<span class="'+a+'">'+n+"</span>"}function p(t){for(var e=i(h),n=0,a=e;n<a.length;n+=1){var r=a[n],s=h[r];t=c(r,s.replace,s["with"],t)}return t}function g(t){var e="";return t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),new RegExp(t.source,e)}function u(a,r,o){function p(t){return a.name&&(t=n(a.name,t)),h[b]={replace:d[0],"with":t},v[b]=w,!m&&{remaining:r.substr(w-o),offset:w}}function u(e){var r=d[e];if(r){var o=a.matches[e],i=o.language,p=o.name&&o.matches?o.matches:o,g=function(t,a,r){y=c(s(d,e),t,r?n(r,a):a,y)};if("string"==typeof o)return void g(r,r,o);var u,l=new I(t);if(i)return u=l.refract(r,i),void g(r,u);u=l.refract(r,f,p.length?p:[p]),g(r,u,o.matches?o.name:0)}}void 0===o&&(o=0);var l=a.pattern;if(!l)return!1;var m=!l.global;l=g(l);var d=l.exec(r);if(!d)return!1;!a.name&&a.matches&&"string"==typeof a.matches[0]&&(a.name=a.matches[0],delete a.matches[0]);var y=d[0],b=d.index+o,w=d[0].length+b;if(b===w)return!1;if(e(b,w))return{remaining:r.substr(w-o),offset:w};for(var x=i(a.matches),N=0,L=x;N<L.length;N+=1){var S=L[N];u(S)}return p(y)}function l(t,e){for(var n=0,a=e;n<a.length;n+=1)for(var r=a[n],s=u(r,t);s;)s=u(r,s.remaining,s.offset);return p(t)}function m(e){for(var n=t.patterns[e]||[];t.inheritenceMap[e];)e=t.inheritenceMap[e],n=n.concat(t.patterns[e]||[]);return n}function d(t,e,n){return f=e,n=n||m(e),l(r(t),n)}var f,h={},v={};this.refract=d},R={},E={},A={},j={},C=t(),M=e(),T=null;j={extend:w,remove:x,onHighlight:b,addAlias:L,color:N},C&&(j.colorSync=function(t,e){var n=f(t,e),a=new k(n.options);return a.refract(n.code,n.lang)}),C||M||document.addEventListener("DOMContentLoaded",function(t){j.defer||j.color(t)},!1),M&&(self.onmessage=g);var B=j;return B}),Rainbow.extend("css",[{name:"comment",pattern:/\/\*[\s\S]*?\*\//gm},{name:"constant.hex-color",pattern:/#([a-f0-9]{3}|[a-f0-9]{6})(?=;|\s|,|\))/gi},{matches:{1:"constant.numeric",2:"keyword.unit"},pattern:/(\d+)(px|em|cm|s|%)?/g},{name:"string",pattern:/('|")(.*?)\1/g},{name:"support.css-property",matches:{1:"support.vendor-prefix"},pattern:/(-o-|-moz-|-webkit-|-ms-)?[\w-]+(?=\s?:)(?!.*\{)/g},{matches:{1:[{name:"entity.name.sass",pattern:/&amp;/g},{name:"direct-descendant",pattern:/&gt;/g},{name:"entity.name.class",pattern:/\.[\w\-_]+/g},{name:"entity.name.id",pattern:/\#[\w\-_]+/g},{name:"entity.name.pseudo",pattern:/:[\w\-_]+/g},{name:"entity.name.tag",pattern:/\w+/g}]},pattern:/([\w\ ,\n:\.\#\&\;\-_]+)(?=.*\{)/g},{matches:{2:"support.vendor-prefix",3:"support.css-value"},pattern:/(:|,)\s*(-o-|-moz-|-webkit-|-ms-)?([a-zA-Z-]*)(?=\b)(?!.*\{)/g}]),Rainbow.addAlias("scss","css"),Rainbow.extend("generic",[{matches:{1:[{name:"keyword.operator",pattern:/\=|\+/g},{name:"keyword.dot",pattern:/\./g}],2:{name:"string",matches:{name:"constant.character.escape",pattern:/\\('|"){1}/g}}},pattern:/(\(|\s|\[|\=|:|\+|\.|\{|,)(('|")([^\\\1]|\\.)*?(\3))/gm},{name:"comment",pattern:/\/\*[\s\S]*?\*\/|(\/\/|\#)(?!.*('|").*?[^:](\/\/|\#)).*?$/gm},{name:"constant.numeric",pattern:/\b(\d+(\.\d+)?(e(\+|\-)?\d+)?(f|d)?|0x[\da-f]+)\b/gi},{matches:{1:"keyword"},pattern:/\b(and|array|as|b(ool(ean)?|reak)|c(ase|atch|har|lass|on(st|tinue))|d(ef|elete|o(uble)?)|e(cho|lse(if)?|xit|xtends|xcept)|f(inally|loat|or(each)?|unction)|global|if|import|int(eger)?|long|new|object|or|pr(int|ivate|otected)|public|return|self|st(ring|ruct|atic)|switch|th(en|is|row)|try|(un)?signed|var|void|while)(?=\b)/gi},{name:"constant.language",pattern:/true|false|null/g},{name:"keyword.operator",pattern:/\+|\!|\-|&(gt|lt|amp);|\||\*|\=/g},{matches:{1:"function.call"},pattern:/(\w+?)(?=\()/g},{matches:{1:"storage.function",2:"entity.name.function"},pattern:/(function)\s(.*?)(?=\()/g}]),Rainbow.extend("html",[{name:"source.php.embedded",matches:{1:"variable.language.php-tag",2:{language:"php"},3:"variable.language.php-tag"},pattern:/(&lt;\?php|&lt;\?=?(?!xml))([\s\S]*?)(\?&gt;)/gm},{name:"source.css.embedded",matches:{1:{matches:{1:"support.tag.style",2:[{name:"entity.tag.style",pattern:/^style/g},{name:"string",pattern:/('|")(.*?)(\1)/g},{name:"entity.tag.style.attribute",pattern:/(\w+)/g}],3:"support.tag.style"},pattern:/(&lt;\/?)(style.*?)(&gt;)/g},2:{language:"css"},3:"support.tag.style",4:"entity.tag.style",5:"support.tag.style"},pattern:/(&lt;style.*?&gt;)([\s\S]*?)(&lt;\/)(style)(&gt;)/gm},{name:"source.js.embedded",matches:{1:{matches:{1:"support.tag.script",2:[{name:"entity.tag.script",pattern:/^script/g},{name:"string",pattern:/('|")(.*?)(\1)/g},{name:"entity.tag.script.attribute",pattern:/(\w+)/g}],3:"support.tag.script"},pattern:/(&lt;\/?)(script.*?)(&gt;)/g},2:{language:"javascript"},3:"support.tag.script",4:"entity.tag.script",5:"support.tag.script"},pattern:/(&lt;script(?! src).*?&gt;)([\s\S]*?)(&lt;\/)(script)(&gt;)/gm},{name:"comment.html",pattern:/&lt;\!--[\S\s]*?--&gt;/g},{matches:{1:"support.tag.open",2:"support.tag.close"},pattern:/(&lt;)|(\/?\??&gt;)/g},{name:"support.tag",matches:{1:"support.tag",2:"support.tag.special",3:"support.tag-name"},pattern:/(&lt;\??)(\/|\!?)(\w+)/g},{matches:{1:"support.attribute"},pattern:/([a-z-]+)(?=\=)/gi},{matches:{1:"support.operator",2:"string.quote",3:"string.value",4:"string.quote"},pattern:/(=)('|")(.*?)(\2)/g},{matches:{1:"support.operator",2:"support.value"},pattern:/(=)([a-zA-Z\-0-9]*)\b/g},{matches:{1:"support.attribute"},pattern:/\s([\w-]+)(?=\s|&gt;)(?![\s\S]*&lt;)/g}]),Rainbow.addAlias("xml","html"),Rainbow.extend("javascript",[{name:"selector",pattern:/\$(?=\.|\()/g},{name:"support",pattern:/\b(window|document)\b/g},{name:"keyword",pattern:/\b(export|default|from)\b/g},{name:"function.call",pattern:/\b(then)(?=\()/g},{name:"variable.language.this",pattern:/\bthis\b/g},{name:"variable.language.super",pattern:/super(?=\.|\()/g},{name:"storage.type",pattern:/\b(const|let|var)(?=\s)/g},{matches:{1:"support.property"},pattern:/\.(length|node(Name|Value))\b/g},{matches:{1:"support.function"},pattern:/(setTimeout|setInterval)(?=\()/g},{matches:{1:"support.method"},pattern:/\.(getAttribute|replace|push|getElementById|getElementsByClassName|setTimeout|setInterval)(?=\()/g},{name:"string.regexp",matches:{1:"string.regexp.open",2:{name:"constant.regexp.escape",pattern:/\\(.){1}/g},3:"string.regexp.close",4:"string.regexp.modifier"},pattern:/(\/)((?![*+?])(?:[^\r\n\[\/\\]|\\.|\[(?:[^\r\n\]\\]|\\.)*\])+)(\/)(?!\/)([igm]{0,3})/g},{matches:{1:"storage.type",3:"entity.function"},pattern:/(var)?(\s|^)(\S+)(?=\s?=\s?function\()/g},{matches:{1:"keyword",2:"variable.type"},pattern:/(new)\s+(?!Promise)([^\(]*)(?=\()/g},{name:"entity.function",pattern:/(\w+)(?=:\s{0,}function)/g},{name:"constant.other",pattern:/\*(?= as)/g},{matches:{1:"keyword",2:"constant.other"},pattern:/(export)\s+(\*)/g},{matches:{1:"storage.type.accessor",2:"entity.name.function"},pattern:/(get|set)\s+(\w+)(?=\()/g},{matches:{2:"entity.name.function"},pattern:/(^\s*)(\w+)(?=\([^\)]*?\)\s*\{)/gm},{matches:{1:"storage.type.class",2:"entity.name.class",3:"storage.modifier.extends",4:"entity.other.inherited-class"},pattern:/(class)\s+(\w+)(?:\s+(extends)\s+(\w+))?(?=\s*\{)/g},{name:"storage.type.function.arrow",pattern:/=&gt;/g},{name:"support.class.promise",pattern:/\bPromise(?=(\(|\.))/g}],"generic"),Rainbow.addAlias("js","javascript"),Rainbow.extend("json",[{matches:{0:{name:"string",matches:{name:"constant.character.escape",pattern:/\\('|"){1}/g}}},pattern:/(\"|\')(\\?.)*?\1/g},{name:"constant.numeric",pattern:/\b(-?(0x)?\d*\.?[\da-f]+|NaN|-?Infinity)\b/gi},{name:"constant.language",pattern:/\b(true|false|null)\b/g}]);